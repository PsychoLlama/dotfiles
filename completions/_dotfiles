#compdef dotfiles

function _dotfiles {
  local -a commands

  # Parse help output into command suggestions.
  dotfiles --help | while read line; do
    # Ignore blank lines and the usage heading.
    if [[ -z "${line// /}" ]] || [[ "$line" =~ "Usage:" ]]; then
      continue
    fi

    local output="$(sed 's/[ ]*-[ ]/:/' <<< "$line")"
    commands=("$output" $commands)
  done

  _describe command commands
}

_dotfiles

# vim: ft=zsh:
